Продакт-менеджер Василий попросил вас проанализировать завершенные уроки и ответить на следующие вопросы:
1. Какое число наших пользователей активно преподаёт или учится (в разрезе по роли)? Как меняются эти показатели из месяца в месяц?

2. Сколько у нас преподавателей и учеников, которые не участвовали ещё ни в одном уроке? (прогул и отмена считается как участие)

3. Сколько у каждого из преподавателя в среднем занятий в неделю (по месяцам)?
SELECT 
  tutor_id, 
  AVG(lessons_in_week) as avg_lessons_in_week, 
  month 
FROM 
  (
    SELECT 
      tutor_id, 
      COUNT(week) as lessons_in_week, 
      month 
    FROM 
      (
        SELECT 
          tutor_id, 
          extract(
            week 
            from 
              scheduled_time
          ) as week, 
          extract(
            month 
            from 
              scheduled_time
          ) as month 
        FROM 
          Lessons
      ) AS tutor_week_month 
    Group by 
      tutor_id, 
      week
  ) as tutor_lessons_in_week 
Group by 
  tutor_id, 
  month;

4. Сколько уроков по каждому из предметов в месяц не состоялись по причине прогула учителя/ученика (по отдельности каждого + общее кол-во)?

5. По каждому предмету определить день недели, в который по этому предмету больше всего уроков + вывести это количество уроков.

6. Если в ноябре прирост составит 300 учеников, сколько нам нужно нанять преподавателей, чтобы сохранить на прежнем уровне (как в октябре) утилизацию преподавателей?
